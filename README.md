# ngnix-to-gateway

| Annotation                                                        | Gateway API support / approach | Notes                                                                                                                                                                        |
| :---------------------------------------------------------------: | :----------------------------: | :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------: |
| nginx.ingress.kubernetes.io/affinity                              | yes                            | currently only affinity via Generated Cookie or Client IP affinity are supported - load balancer supports additional approaches but must use standalone NEG approach https://docs.cloud.google.com/kubernetes-engine/docs/how-to/configure-gateway-resources#session_affinity |
| nginx.ingress.kubernetes.io/allowSnippetAnnotations               | no                             | Note: Snippets were considered security risk. Google approach (in preview) for customizing load balancer behavior is via Service Extensions https://docs.cloud.google.com/kubernetes-engine/docs/how-to/configure-gke-service-extensions                          |
| nginx.ingress.kubernetes.io/auth-response-headers                 | \-                             |                                                                                                                                                                              |
| nginx.ingress.kubernetes.io/auth-signin                           | \-                             | Recommended browser-based authentication approach (if performing at load balancer layer \*instead\* of application) is to use Identity Aware Proxy https://cloud.google.com/security/products/iap https://docs.cloud.google.com/kubernetes-engine/docs/how-to/configure-gateway-resources#configure_iap           |
| nginx.ingress.kubernetes.io/auth-tls-pass-certificate-to-upstream | \-                             | coming next year                                                                                                                                                             |
| nginx.ingress.kubernetes.io/auth-tls-secret                       | \-                             | https://docs.cloud.google.com/kubernetes-engine/docs/how-to/secure-gateway                                                                                                                                                                      |
| nginx.ingress.kubernetes.io/auth-tls-verify-client                | \-                             | mTLS? if so, mTLS is on roadmap for GKE Gateway, but is available today via standalone NEGs; note that frontend mTLS is experimental in OSS Gateway API                      |
| nginx.ingress.kubernetes.io/auth-tls-verify-depth                 | \-                             |                                                                                                                                                                              |
| nginx.ingress.kubernetes.io/auth-url                              | \-                             |                                                                                                                                                                              |
| nginx.ingress.kubernetes.io/backend-protocol                      | yes                            | https://docs.cloud.google.com/kubernetes-engine/docs/how-to/secure-gateway#load-balancer-tls                                                                                                                                                                      |
| nginx.ingress.kubernetes.io/client-header-buffer-size             | no                             | not configurable - limits documented here - https://docs.cloud.google.com/load-balancing/docs/quotas#https-lb-header-limits                                                                                                                          |
| nginx.ingress.kubernetes.io/cors-allow-credentials                | no\*                           | work underway for native support, but current approach is to utilize custom header capability https://cloud.google.com/kubernetes-engine/docs/how-to/deploying-gateways#configure_custom_request_and_response_headers                                                                        |
| nginx.ingress.kubernetes.io/cors-allow-headers                    | \-                             |                                                                                                                                                                              |
| nginx.ingress.kubernetes.io/cors-allow-methods                    | \-                             |                                                                                                                                                                              |
| nginx.ingress.kubernetes.io/cors-allow-origin                     | \-                             |                                                                                                                                                                              |
| nginx.ingress.kubernetes.io/enable-cors                           | \-                             |                                                                                                                                                                              |
| nginx.ingress.kubernetes.io/enable-websocket                      | yes\*                          | Load Balancer natively supports this - no additional configuration required                                                                                                  |
| nginx.ingress.kubernetes.io/force-ssl-redirect                    | yes                            | https://docs.cloud.google.com/kubernetes-engine/docs/how-to/deploying-gateways#configure_http-to-https_redirects                                                                                                                                                                      |
| nginx.ingress.kubernetes.io/hsts                                  | yes\*                          | Add custom response headers https://cloud.google.com/kubernetes-engine/docs/how-to/deploying-gateways#configure_custom_request_and_response_headers                                                                                                                                          |
| nginx.ingress.kubernetes.io/large-client-header-buffers           | \-                             | clarify use case                                                                                                                                                             |
| nginx.ingress.kubernetes.io/proxy-body-size                       | \-                             | clarify use case                                                                                                                                                             |
| nginx.ingress.kubernetes.io/proxy-buffer-size                     | \-                             | clarify use case                                                                                                                                                             |
| nginx.ingress.kubernetes.io/proxy-buffers                         | \-                             | clarify use case                                                                                                                                                             |
| nginx.ingress.kubernetes.io/proxy-connect-timeout                 | \-                             | clarify use case - configurable between LB and backend                                                                                                                       |
| nginx.ingress.kubernetes.io/proxy-read-timeout                    | \-                             | clarify use case - configurable between LB and backend                                                                                                                       |
| nginx.ingress.kubernetes.io/proxy-send-timeout                    | \-                             | clarify use case - configurable between LB and backend                                                                                                                       |
| nginx.ingress.kubernetes.io/proxy\_connect\_timeout               | \-                             | clarify use case - configurable between LB and backend                                                                                                                       |
| nginx.ingress.kubernetes.io/proxy\_next\_upstream\_timeout        | \-                             | clarify use case - configurable between LB and backend                                                                                                                       |
| nginx.ingress.kubernetes.io/proxy\_read\_timeout                  | \-                             | clarify use case - configurable between LB and backend                                                                                                                       |
| nginx.ingress.kubernetes.io/proxy\_send\_timeout                  | \-                             | clarify use case - configurable between LB and backend                                                                                                                       |
| nginx.ingress.kubernetes.io/rewrite-target                        | yes                            | https://docs.cloud.google.com/kubernetes-engine/docs/how-to/deploying-gateways#configure_path_redirects_and_url_rewrites                                                                                                                                                                      |
| nginx.ingress.kubernetes.io/secure-backends                       | yes\*                          | https://docs.cloud.google.com/kubernetes-engine/docs/how-to/secure-gateway#load-balancer-tls                                                                                                                                                                      |
| nginx.ingress.kubernetes.io/send-timeout                          | yes\*                          | https://docs.cloud.google.com/kubernetes-engine/docs/how-to/configure-gateway-resources#configure_timeout                                                                                                                                                                      |
| nginx.ingress.kubernetes.io/service-upstream                      | no                             | not applicable - https://docs.cloud.google.com/kubernetes-engine/docs/concepts/container-native-load-balancing                                                                                                                                                     |
| nginx.ingress.kubernetes.io/session-cookie-expires                | \-                             | See response for nginx.ingress.kubernetes.io/affinity                                                                                                                        |
| nginx.ingress.kubernetes.io/session-cookie-hash                   | \-                             | See response for nginx.ingress.kubernetes.io/affinity                                                                                                                        |
| nginx.ingress.kubernetes.io/session-cookie-max-age                | \-                             | See response for nginx.ingress.kubernetes.io/affinity                                                                                                                        |
| nginx.ingress.kubernetes.io/session-cookie-name                   | \-                             | See response for nginx.ingress.kubernetes.io/affinity                                                                                                                        |
| nginx.ingress.kubernetes.io/session-cookie-path                   | \-                             | See response for nginx.ingress.kubernetes.io/affinity                                                                                                                        |
| nginx.ingress.kubernetes.io/ssl-ciphers                           | yes                            | https://docs.cloud.google.com/kubernetes-engine/docs/how-to/configure-gateway-resources#configure_ssl_policies                                                                                                                                                                     |
| nginx.ingress.kubernetes.io/ssl-passthrough                       | no                             | All Google ALBs (L7) terminate TLS; passthru coming via L4                                                                                                                   |
| nginx.ingress.kubernetes.io/ssl-protocols                         | yes                            | https://docs.cloud.google.com/kubernetes-engine/docs/how-to/configure-gateway-resources#configure_ssl_policies                                                                                                                                                                      |
| nginx.ingress.kubernetes.io/ssl-redirect                          | yes                            | https://docs.cloud.google.com/kubernetes-engine/docs/how-to/deploying-gateways#configure_http-to-https_redirects                                                                                                                                                                      |
| nginx.ingress.kubernetes.io/upstream-vhost                        | ??                             | nginx specific? clarify use case                                                                                                                                             |
| nginx.ingress.kubernetes.io/use-forwarded-headers                 | yes\*                          | clarify use case - ALBs forward client headers to backend                                                                                                                    |
| nginx.ingress.kubernetes.io/use-http2                             | yes                            | To backend, configure using AppProtocol field in service spec to either HTTP2 or H2C (cleartext); frontend will negotiate to HTTP/2 https://docs.cloud.google.com/kubernetes-engine/docs/how-to/secure-gateway#load-balancer-tls                                  |
| nginx.ingress.kubernetes.io/use-regex                             | no                             | load balancer supports it via standalone NEGs, but not exposed via GKE Gateway currently - https://docs.cloud.google.com/load-balancing/docs/url-map-concepts#regex-support                                                                           |
| nginx.ingress.kubernetes.io/whitelist-source-range                | yes                            | via Cloud Armor integration https://docs.cloud.google.com/kubernetes-engine/docs/how-to/configure-gateway-resources#configure_cloud_armor                                                                                                                                           |
| nginx.ingress.kubernetes.io/x-forwarded-prefix                    | no                             | nginx specific? Inherits behavior of the underlying LB. i.e. https://docs.cloud.google.com/load-balancing/docs/https#target-proxies & https://docs.cloud.google.com/load-balancing/docs/l7-internal#target_proxy                                                                                               |
